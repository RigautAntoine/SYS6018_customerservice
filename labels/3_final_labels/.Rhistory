orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 10)
m_orange <- rnorm(10, -1, 10)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 1)
m_orange <- rnorm(10, -1, 1)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 5)
m_orange <- rnorm(10, -1, 5)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
m_blue <- rnorm(10, 1, 3)
m_orange <- rnorm(10, -1, 3)
blue1 <- sample(1:10, 100, replace = T)
blue2 <- sample(1:10, 100, replace = T)
orange1 <- sample(1:10, 100, replace = T)
orange2 <- sample(1:10, 100, replace = T)
blue <- cbind(sapply(blue1, function(p)rnorm(1, m_blue[p], 1)),
sapply(blue2, function(p)rnorm(1, m_blue[p], 1)))
orange <- cbind(sapply(orange1, function(p)rnorm(1, m_orange[p], 1)),
sapply(orange2, function(p)rnorm(1, m_orange[p], 1)))
df <- data.frame(rbind(blue, orange))
df$y <- factor(c(rep("blue", 100), rep("orange", 100)))
plot(df$X1, df$X2, col=df$y, pch=20)
rbivariate <- function(mean.x = 70, sd.x=3, mean.y=162, sd.y=14, r=.50, iter=100) {
z1 <- rnorm(iter)
z2 <- rnorm(iter)
x <- sqrt(1-r^2)*sd.x*z1 + r*sd.x*z2 + mean.x
y <- sd.y*z2 + mean.y
return(list(x,y))
}
data <- rbivariate(iter=1000)
data
data <- rbivariate(iter=1000)
mean(data[[1]])
sd(data[[1]])
mean(data[[2]])
sd(data[[2]])
plot(data[[1]],data[[2]])
stay <- read.table("//hstsfssdata1/clinlabs$/Microbio/CRE Environmental/physician_codes/amvisits.txt", sep="\t", stringsAsFactors = F, header = F)
stay <- read.table("//hstsfssdata1/clinlabs$/Microbio/CRE Environmental/physician_codes/amvisits.txt", sep="\t", stringsAsFactors = F, header = F)
load("C:/UVA/DataMining/SYS6018_customerservice/script/logisticRegression.RData")
library(tm)
library(stringr)
library(slam)
library(glmnet)
setwd("C:/UVA/DataMining/SYS6018_customerservice/labels/3_final_labels")
scores <- read.csv("sentimentScores.csv", stringsAsFactors = F)
names(scores)[5] <- "sentiment"
scores <- scores[,c("text", "industry", "sentiment", "complaint")]
tweets <- read.csv("trainData.csv", stringsAsFactors = T)
POStags <- read.csv("POStags.csv", sep = "\t", header = F, stringsAsFactors = F)
names(POStags) <- c("token", "tag", "confidence", "original")
tweets$tokens <- apply(POStags, 1, function(x){
tags <- unlist(str_split(x[2]," "))
tokens <- unlist(str_split(x[1]," "))
confidence <- as.numeric(gsub(",", ".", unlist(str_split(x[3], " "))))
return(paste(tokens[(tags %in% c("N", "^", "Z", "V", "M", "A", "R", "Y", "#")) & confidence > 0.6], collapse=" "))
})
tweets$sentiment <- scores$sentiment
tweets[tweets$tokens == "",] # None of these are complaints. It is safe to get rid of them
tweets <- tweets[tweets$tokens != "",]
docvar <- list(industry="industry", content="tokens", complaint="complaint", sentiment="sentiment")
myReader <- readTabular(mapping=docvar)
corpus <- Corpus(DataframeSource(tweets), readerControl=list(reader=myReader))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeWords, c(stopwords("english"), "https",'southwestair', "americanairlines", "delta", "united", "deltaassist", "americanair", "jetblue", "comcast", "comcastcares","verizonsupport","vzwsupport", "verizon", "att", "attcares", "tmobilehelp", "dish", "hulu_support", "dish_answers", "hulu", "tmobile", "comcastsucks"))
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, stripWhitespace)
dtm = DocumentTermMatrix(corpus, control = list(minWordLength = 3, bounds=list(global=c(5,5125))))
dtm
corpus <- corpus[row_sums(dtm) > 0] # Note that this makes us lose 7 complaints out of 120 tweets
dtm <- dtm[row_sums(dtm) > 0,] # And we suppress the documents that are now empty
dtm
df <- data.frame( complaint <- unlist(meta(corpus, "complaint")), sentiment <- unlist(meta(corpus, "sentiment")), as.matrix(dtm))
View(df)
df <- data.frame( complaint = unlist(meta(corpus, "complaint")), sentiment = unlist(meta(corpus, "sentiment")), as.matrix(dtm))
save(df, "trainingData.RData")
save(df, file="trainingData.RData")
dtm.m <- cbind(unlist(meta(corpus, "complaint")), unlist(meta(corpus, "sentiment")), as.matrix(dtm))
set.seed(1)
ind <- sample(nrow(dtm.m), 3000)
train <- dtm.m[ind,] # Train has about 70% of the set
test <- dtm.m[-ind,] # Test has the remaining 30%
cv.lam <- cv.glmnet(train[,-1], factor(train[,1]), alpha=1, family="binomial", type.measure = "class")
plot(cv.lam)
bestlam <- cv.lam$lambda.min # best lambda as selected by cross validation
bestlam
log(bestlam) # what's in the plot
trainll <- glmnet(train[,-1], factor(train[,1]), alpha=1, family="binomial")
trainll.coef <- predict(trainll, type="coefficients", s=bestlam)
coef.df <- data.frame(word = unlist(trainll.coef@Dimnames[1]), as.matrix(trainll.coef))
coef.df$word <- as.character(coef.df$word)
coef.df <- coef.df[coef.df$X1 != 0,]
coef.df <- coef.df[order(coef.df$X1, decreasing = T),]
View(coef.df)
coef.df[coef.df$word="sentiment",]
coef.df[coef.df$word=="sentiment",]
probs <- predict(trainll, newx = test[,-1], s = bestlam, type="response")
testPred <- predict(trainll, newx = test[,-1], s = bestlam, type="class")
table(testPred, test[,1])
sum(testPred == test[,1]) / length(testPred) # 83% Accuracy
# Recall
sum(testPred == 1 & testPred == test[,1]) / sum(test[,1] == 1) # 55% recall
# Precision
sum(testPred == 1 & testPred == test[,1]) / sum(testPred == 1) # 77% precision
# AUC curve
preds <- prediction(probs, test[,1])
perf <- performance(preds, measure = "tpr", x.measure = "fpr")
auc <- performance(preds, measure = "auc")
auc <- auc@y.values[[1]]
roc.data <- data.frame(fpr=unlist(perf@x.values),
tpr=unlist(perf@y.values),
model="GLM")
ggplot(roc.data, aes(x=fpr, ymin=0, ymax=tpr)) +
geom_ribbon(alpha=0.2) +
geom_line(aes(y=tpr)) +
ggtitle(paste0("ROC Curve w/ AUC=", auc))
library(ROCR)
preds <- prediction(probs, test[,1])
perf <- performance(preds, measure = "tpr", x.measure = "fpr")
auc <- performance(preds, measure = "auc")
auc <- auc@y.values[[1]]
roc.data <- data.frame(fpr=unlist(perf@x.values),
tpr=unlist(perf@y.values),
model="GLM")
ggplot(roc.data, aes(x=fpr, ymin=0, ymax=tpr)) +
geom_ribbon(alpha=0.2) +
geom_line(aes(y=tpr)) +
ggtitle(paste0("ROC Curve w/ AUC=", auc))
library(ggplot2)
ggplot(roc.data, aes(x=fpr, ymin=0, ymax=tpr)) +
geom_ribbon(alpha=0.2) +
geom_line(aes(y=tpr)) +
ggtitle(paste0("ROC Curve w/ AUC=", auc))
save.image("logisticRegression.RData")
load("trainingData.RData")
